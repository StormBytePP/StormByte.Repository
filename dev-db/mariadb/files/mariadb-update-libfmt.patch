From d8aa09433d36234208af90d79653a837a4f0358a Mon Sep 17 00:00:00 2001
From: "David C. Manuelda" <StormByte@gmail.com>
Date: Tue, 6 May 2025 16:01:13 +0200
Subject: [PATCH] Update FMT

---
 cmake/libfmt.cmake  | 5 ++---
 sql/item_strfunc.cc | 1 -
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/cmake/libfmt.cmake b/cmake/libfmt.cmake
index a9dc6937..98b20065 100644
--- a/cmake/libfmt.cmake
+++ b/cmake/libfmt.cmake
@@ -28,15 +28,14 @@ MACRO (CHECK_LIBFMT)
   IF(WITH_LIBFMT STREQUAL "system" OR WITH_LIBFMT STREQUAL "auto")
     SET(CMAKE_REQUIRED_INCLUDES ${LIBFMT_INCLUDE_DIR})
     CHECK_CXX_SOURCE_RUNS(
-    "#define FMT_STATIC_THOUSANDS_SEPARATOR ','
-     #define FMT_HEADER_ONLY 1
+    "#define FMT_HEADER_ONLY 1
      #include <fmt/args.h>
      int main() {
        using ArgStore= fmt::dynamic_format_arg_store<fmt::format_context>;
        ArgStore arg_store;
        int answer= 4321;
        arg_store.push_back(answer);
-       return fmt::vformat(\"{:L}\", arg_store).compare(\"4,321\");
+       return fmt::vformat(std::locale(\"en_US.UTF-8\"), \"{:L}\", arg_store).compare(\"4,321\");
      }" HAVE_SYSTEM_LIBFMT)
     SET(CMAKE_REQUIRED_INCLUDES)
   ENDIF()
diff --git a/sql/item_strfunc.cc b/sql/item_strfunc.cc
index 12d96cb4..0df0020c 100644
--- a/sql/item_strfunc.cc
+++ b/sql/item_strfunc.cc
@@ -61,7 +61,6 @@ C_MODE_END
 #endif
 
 /* fmtlib include (https://fmt.dev/). */
-#define FMT_STATIC_THOUSANDS_SEPARATOR ','
 #define FMT_HEADER_ONLY 1
 #include "fmt/args.h"
 
-- 
2.49.0

